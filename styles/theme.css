/* ==========================================================================
   NSAW Schema Explorer — Global CSS Custom Properties
   ==========================================================================
   Design-system tokens for theming, colors, typography, and component styles.

   Structure:
     1. Shared tokens          — motion, fonts (always active)
     2. Dark mode variables    — default palette (:root / [data-theme="dark"])
     3. Light mode variables   — light palette ([data-theme="light"])
     4. Utility classes        — reusable helpers, glow effects, overrides
   ========================================================================== */


/* ==========================================================================
   1. SHARED TOKENS
   Timing curves and font stacks used across both themes.
   ========================================================================== */

:root {
  /* Transitions */
  --theme-transition-fast: 150ms ease;
  --theme-transition-base: 200ms ease;
  --theme-transition-slow: 300ms ease;
  --theme-transition-mode: 500ms ease;

  /* Typography */
  --theme-font-ui: 'Inter', system-ui, sans-serif;
  --theme-font-mono: 'JetBrains Mono', ui-monospace, monospace;
}


/* ==========================================================================
   2. DARK MODE (default)
   Applied on :root so the app starts dark, and explicitly on [data-theme="dark"]
   for programmatic toggling.
   ========================================================================== */

:root,
[data-theme="dark"] {

  /* --- Backgrounds -------------------------------------------------------- */
  --theme-bg-base:      #0f172a;                    /* slate-950 */
  --theme-bg-surface:   #0f172a;                    /* slate-950 */
  --theme-bg-elevated:  #1e293b;                    /* slate-800 */
  --theme-bg-overlay:   rgba(15, 23, 42, 0.8);
  --theme-bg-panel:     rgba(15, 23, 42, 0.5);      /* glass panels, TopNav */
  --theme-bg-inset:     rgba(15, 23, 42, 0.3);
  --theme-bg-hover:     #1e293b;                    /* slate-800 */
  --theme-bg-active:    rgba(37, 99, 235, 0.1);     /* blue-600/10 */

  /* --- Surfaces (glass layering) ------------------------------------------ */
  --theme-surface-card:     rgba(30, 41, 59, 0.8);  /* slate-800/80, LineageNode bg */
  --theme-surface-dropdown: #0f172a;
  --theme-surface-tooltip:  rgba(15, 23, 42, 0.95);
  --theme-surface-legend:   rgba(15, 23, 42, 0.9);

  /* --- Text --------------------------------------------------------------- */
  --theme-text-primary:   #f8fafc;                  /* slate-50 */
  --theme-text-default:   #e2e8f0;                  /* slate-200 */
  --theme-text-secondary: #cbd5e1;                  /* slate-300 */
  --theme-text-tertiary:  #94a3b8;                  /* slate-400 */
  --theme-text-muted:     #64748b;                  /* slate-500 */
  --theme-text-faint:     #475569;                  /* slate-600 */

  /* --- Borders ------------------------------------------------------------ */
  --theme-border-default: #1e293b;                  /* slate-800 */
  --theme-border-subtle:  #0f172a;                  /* slate-900 */
  --theme-border-strong:  #334155;                  /* slate-700 */
  --theme-border-hover:   #475569;                  /* slate-600 */
  --theme-hud-border:     rgba(248, 250, 252, 0.15); /* white @ 15% for HUD frame */

  /* --- Accent: Blue (Presentation / Semantic layer) ----------------------- */
  --theme-accent-blue:             #3b82f6;
  --theme-accent-blue-light:       #60a5fa;
  --theme-accent-blue-dark:        #2563eb;
  --theme-accent-blue-bg:          rgba(59, 130, 246, 0.05);
  --theme-accent-blue-border:      rgba(59, 130, 246, 0.3);
  --theme-accent-blue-glow:        rgba(59, 130, 246, 0.5);
  --theme-accent-blue-ring:        rgba(59, 130, 246, 0.3);
  --theme-accent-blue-border-half: rgba(59, 130, 246, 0.5);  /* node border normal */
  --theme-accent-blue-text:        #60a5fa;                   /* blue-400 for text on dark */

  /* --- Accent: Purple (Physical DW tables) -------------------------------- */
  --theme-accent-purple:             #a855f7;
  --theme-accent-purple-light:       #c084fc;
  --theme-accent-purple-dark:        #7c3aed;
  --theme-accent-purple-bg:          rgba(168, 85, 247, 0.05);
  --theme-accent-purple-border:      rgba(168, 85, 247, 0.3);
  --theme-accent-purple-glow:        rgba(168, 85, 247, 0.5);
  --theme-accent-purple-ring:        rgba(168, 85, 247, 0.3);
  --theme-accent-purple-border-half: rgba(168, 85, 247, 0.5);
  --theme-accent-purple-text:        #c084fc;                  /* purple-300/400 for text */

  /* --- Accent: Orange (Physical DW columns) ------------------------------- */
  --theme-accent-orange:             #f97316;
  --theme-accent-orange-light:       #fb923c;
  --theme-accent-orange-bg:          rgba(249, 115, 22, 0.05);
  --theme-accent-orange-border:      rgba(249, 115, 22, 0.3);
  --theme-accent-orange-glow:        rgba(249, 115, 22, 0.5);
  --theme-accent-orange-ring:        rgba(249, 115, 22, 0.3);
  --theme-accent-orange-border-half: rgba(249, 115, 22, 0.5);
  --theme-accent-orange-text:        #fb923c;                  /* orange-400 for text */

  /* --- Accent: Emerald (NetSuite source inferred) ------------------------- */
  --theme-accent-emerald:        #10b981;
  --theme-accent-emerald-light:  #34d399;
  --theme-accent-emerald-bg:     rgba(16, 185, 129, 0.05);
  --theme-accent-emerald-border: rgba(16, 185, 129, 0.3);
  --theme-accent-emerald-glow:   rgba(16, 185, 129, 0.5);
  --theme-accent-emerald-text:   #34d399;                      /* emerald-400 */

  /* --- Accent: Amber (NSAW generated) ------------------------------------- */
  --theme-accent-amber:        #f59e0b;
  --theme-accent-amber-light:  #fbbf24;
  --theme-accent-amber-bg:     rgba(245, 158, 11, 0.1);
  --theme-accent-amber-border: rgba(245, 158, 11, 0.3);
  --theme-accent-amber-text:   #fbbf24;                        /* amber-400 */

  /* --- Accent: Cyan (Welcome / Highlights) -------------------------------- */
  /* Shifted from vivid cyan-400 (#22d3ee) to softer sky-300 (#7dd3fc) */
  --theme-accent-cyan:        #7dd3fc;
  --theme-accent-cyan-dark:   #38bdf8;
  --theme-accent-cyan-faint:  rgba(125, 211, 252, 0.1);
  --theme-accent-cyan-text:   #7dd3fc;
  --theme-accent-cyan-border: rgba(125, 211, 252, 0.4);

  /* --- Additional accent text (TopNav search results) --------------------- */
  --theme-accent-green-text:  #4ade80;                         /* green-400 */
  --theme-accent-yellow-text: #facc15;                         /* yellow-400 */

  /* --- Grid --------------------------------------------------------------- */
  --theme-grid-dot: #475569;                                   /* slate-600 (was slate-700, more visible) */

  /* --- Scrollbar ---------------------------------------------------------- */
  --theme-scrollbar-thumb:       #334155;
  --theme-scrollbar-thumb-hover: #475569;

  /* --- SVG (IsometricStack) ----------------------------------------------- */
  --theme-svg-slab-inactive: rgba(30, 41, 59, 0.4);
  --theme-svg-slab-active:   rgba(125, 211, 252, 0.08);        /* softer sky-300 tint */
  --theme-svg-slab-side:     rgba(30, 41, 59, 0.6);
  --theme-svg-line:          rgba(186, 230, 253, 0.4);
  --theme-svg-line-highlight: #7dd3fc;

  /* --- D3 (StarSchemaNetwork) --------------------------------------------- */
  --theme-d3-edge:             #475569;
  --theme-d3-text:             #e2e8f0;
  --theme-d3-text-bright:      #f8fafc;
  --theme-d3-hover-primary:    #c084fc;
  --theme-d3-hover-secondary:  #a78bfa;
  --theme-d3-hover-dimension:  #60a5fa;
  --theme-d3-hover-stroke:     #60a5fa;

  /* --- React Flow --------------------------------------------------------- */
  --theme-rf-edge:         #475569;
  --theme-rf-edge-primary: #64748b;
  --theme-rf-bg:           #475569;                            /* aligned with --theme-grid-dot */
  --theme-rf-minimap-mask: rgba(15, 23, 42, 0.8);

  /* --- Node active state -------------------------------------------------- */
  --theme-node-active-border: #38bdf8;
  --theme-node-active-glow:   rgba(56, 189, 248, 0.2);
  --theme-node-active-bg:     rgba(15, 23, 42, 0.9);

  /* --- Error / Red (LoadingScreen) ---------------------------------------- */
  --theme-accent-red-text:   #f87171;                          /* red-400 */
  --theme-accent-red-bg:     rgba(239, 68, 68, 0.1);
  --theme-accent-red-border: rgba(239, 68, 68, 0.2);
}


/* ==========================================================================
   3. LIGHT MODE
   Activated by setting data-theme="light" on a parent element (usually <html>).
   ========================================================================== */

[data-theme="light"] {

  /* --- Backgrounds -------------------------------------------------------- */
  --theme-bg-base:     #ffffff;
  --theme-bg-surface:  #f8fafc;                     /* slate-50 */
  --theme-bg-elevated: #f1f5f9;                     /* slate-100 */
  --theme-bg-overlay:  rgba(255, 255, 255, 0.8);
  --theme-bg-panel:    rgba(255, 255, 255, 0.7);
  --theme-bg-inset:    rgba(241, 245, 249, 0.5);
  --theme-bg-hover:    #f1f5f9;                     /* slate-100 */
  --theme-bg-active:   rgba(37, 99, 235, 0.12);

  /* --- Surfaces ----------------------------------------------------------- */
  --theme-surface-card:     rgba(255, 255, 255, 0.9);
  --theme-surface-dropdown: #ffffff;
  --theme-surface-tooltip:  rgba(255, 255, 255, 0.97);
  --theme-surface-legend:   rgba(255, 255, 255, 0.95);

  /* --- Text --------------------------------------------------------------- */
  --theme-text-primary:   #0f172a;                  /* slate-900 */
  --theme-text-default:   #1e293b;                  /* slate-800 */
  --theme-text-secondary: #334155;                  /* slate-700 */
  --theme-text-tertiary:  #475569;                  /* slate-600 — AAA 7.3:1 */
  --theme-text-muted:     #64748b;                  /* slate-500 — AA 5.4:1 */
  --theme-text-faint:     #94a3b8;                  /* slate-400 — AA-large 3.5:1 */

  /* --- Borders ------------------------------------------------------------ */
  --theme-border-default: #cbd5e1;                  /* slate-300 — visible on white */
  --theme-border-subtle:  #e2e8f0;                  /* slate-200 */
  --theme-border-strong:  #cbd5e1;                  /* slate-300 */
  --theme-border-hover:   #94a3b8;                  /* slate-400 */
  --theme-hud-border:     rgba(100, 116, 139, 0.25); /* slate-500 @ 25% for HUD frame */

  /* --- Accent: Blue (slightly darker for light bg contrast) --------------- */
  --theme-accent-blue:             #2563eb;
  --theme-accent-blue-light:       #3b82f6;
  --theme-accent-blue-dark:        #1d4ed8;
  --theme-accent-blue-bg:          rgba(37, 99, 235, 0.06);
  --theme-accent-blue-border:      rgba(37, 99, 235, 0.25);
  --theme-accent-blue-glow:        rgba(37, 99, 235, 0.3);
  --theme-accent-blue-ring:        rgba(37, 99, 235, 0.25);
  --theme-accent-blue-border-half: rgba(37, 99, 235, 0.4);
  --theme-accent-blue-text:        #2563eb;

  /* --- Accent: Purple ----------------------------------------------------- */
  --theme-accent-purple:             #9333ea;
  --theme-accent-purple-light:       #a855f7;
  --theme-accent-purple-dark:        #6d28d9;
  --theme-accent-purple-bg:          rgba(147, 51, 234, 0.06);
  --theme-accent-purple-border:      rgba(147, 51, 234, 0.25);
  --theme-accent-purple-glow:        rgba(147, 51, 234, 0.3);
  --theme-accent-purple-ring:        rgba(147, 51, 234, 0.25);
  --theme-accent-purple-border-half: rgba(147, 51, 234, 0.4);
  --theme-accent-purple-text:        #7c3aed;

  /* --- Accent: Orange ----------------------------------------------------- */
  --theme-accent-orange:             #ea580c;
  --theme-accent-orange-light:       #f97316;
  --theme-accent-orange-bg:          rgba(234, 88, 12, 0.06);
  --theme-accent-orange-border:      rgba(234, 88, 12, 0.25);
  --theme-accent-orange-glow:        rgba(234, 88, 12, 0.3);
  --theme-accent-orange-ring:        rgba(234, 88, 12, 0.25);
  --theme-accent-orange-border-half: rgba(234, 88, 12, 0.4);
  --theme-accent-orange-text:        #ea580c;

  /* --- Accent: Emerald ---------------------------------------------------- */
  --theme-accent-emerald:        #059669;
  --theme-accent-emerald-light:  #10b981;
  --theme-accent-emerald-bg:     rgba(5, 150, 105, 0.06);
  --theme-accent-emerald-border: rgba(5, 150, 105, 0.25);
  --theme-accent-emerald-glow:   rgba(5, 150, 105, 0.3);
  --theme-accent-emerald-text:   #059669;

  /* --- Accent: Amber ------------------------------------------------------ */
  --theme-accent-amber:        #d97706;
  --theme-accent-amber-light:  #f59e0b;
  --theme-accent-amber-bg:     rgba(217, 119, 6, 0.08);
  --theme-accent-amber-border: rgba(217, 119, 6, 0.25);
  --theme-accent-amber-text:   #b45309;

  /* --- Accent: Cyan ------------------------------------------------------- */
  /* Shifted to sky-600/700 for better contrast on light backgrounds */
  --theme-accent-cyan:        #0284c7;
  --theme-accent-cyan-dark:   #0369a1;
  --theme-accent-cyan-faint:  rgba(2, 132, 199, 0.08);
  --theme-accent-cyan-text:   #0284c7;
  --theme-accent-cyan-border: rgba(2, 132, 199, 0.35);

  /* --- Additional accent text --------------------------------------------- */
  --theme-accent-green-text:  #16a34a;              /* green-600 */
  --theme-accent-yellow-text: #ca8a04;              /* yellow-600 */

  /* --- Grid --------------------------------------------------------------- */
  --theme-grid-dot: #cbd5e1;                        /* slate-300 (was slate-200, more visible) */

  /* --- Scrollbar ---------------------------------------------------------- */
  --theme-scrollbar-thumb:       #cbd5e1;
  --theme-scrollbar-thumb-hover: #94a3b8;

  /* --- SVG (IsometricStack) ----------------------------------------------- */
  --theme-svg-slab-inactive: rgba(241, 245, 249, 0.6);
  --theme-svg-slab-active:   rgba(2, 132, 199, 0.08);  /* softer sky-600 tint */
  --theme-svg-slab-side:     rgba(226, 232, 240, 0.7);
  --theme-svg-line:          rgba(71, 85, 105, 0.5);   /* slate-600 base, higher opacity */
  --theme-svg-line-highlight: #0284c7;

  /* --- D3 (StarSchemaNetwork) --------------------------------------------- */
  --theme-d3-edge:             #cbd5e1;
  --theme-d3-text:             #1e293b;
  --theme-d3-text-bright:      #0f172a;
  --theme-d3-hover-primary:    #a855f7;
  --theme-d3-hover-secondary:  #8b5cf6;
  --theme-d3-hover-dimension:  #3b82f6;
  --theme-d3-hover-stroke:     #3b82f6;

  /* --- React Flow --------------------------------------------------------- */
  --theme-rf-edge:         #cbd5e1;
  --theme-rf-edge-primary: #94a3b8;
  --theme-rf-bg:           #cbd5e1;                  /* aligned with --theme-grid-dot */
  --theme-rf-minimap-mask: rgba(255, 255, 255, 0.8);

  /* --- Node active state -------------------------------------------------- */
  --theme-node-active-border: #0284c7;
  --theme-node-active-glow:   rgba(2, 132, 199, 0.2);
  --theme-node-active-bg:     rgba(255, 255, 255, 0.95);

  /* --- Error / Red -------------------------------------------------------- */
  --theme-accent-red-text:   #dc2626;               /* red-600 */
  --theme-accent-red-bg:     rgba(220, 38, 38, 0.08);
  --theme-accent-red-border: rgba(220, 38, 38, 0.2);
}


/* ==========================================================================
   4. UTILITY CLASSES
   Reusable helpers for toggling, glow effects, transition orchestration,
   and React Flow component overrides.
   ========================================================================== */

/* --- Theme toggle button -------------------------------------------------- */

.theme-toggle {
  color: var(--theme-text-tertiary);
  background: transparent;
  border: none;
  cursor: pointer;
  padding: 0.5rem;
  border-radius: 0.375rem;
  transition: all var(--theme-transition-fast);
  display: flex;
  align-items: center;
  justify-content: center;
}

.theme-toggle:hover {
  color: var(--theme-text-primary);
  background: var(--theme-bg-hover);
}

.theme-toggle:focus-visible {
  outline: 2px solid var(--theme-accent-blue);
  outline-offset: 2px;
}

/* --- Glow effects --------------------------------------------------------- */

.glow-blue    { box-shadow: 0 0 8px var(--theme-accent-blue-glow); }
.glow-purple  { box-shadow: 0 0 8px var(--theme-accent-purple-glow); }
.glow-emerald { box-shadow: 0 0 8px var(--theme-accent-emerald-glow); }
.glow-orange  { box-shadow: 0 0 8px var(--theme-accent-orange-glow); }
.glow-active  { box-shadow: 0 0 15px var(--theme-node-active-glow); }

/* --- Theme transition class -----------------------------------------------
   Applied temporarily during theme switch to animate all color properties.
   Remove after the transition completes to avoid interfering with normal
   component transitions.
   -------------------------------------------------------------------------- */

.theme-transitioning,
.theme-transitioning *,
.theme-transitioning *::before,
.theme-transitioning *::after {
  transition: background-color 500ms ease,
              color 500ms ease,
              border-color 500ms ease,
              box-shadow 500ms ease,
              fill 500ms ease,
              stroke 500ms ease !important;
}

/* --- React Flow overrides: Dark mode -------------------------------------- */

[data-theme="dark"] .react-flow__controls {
  background: var(--theme-bg-elevated);
  border-color: var(--theme-border-strong);
}

[data-theme="dark"] .react-flow__controls button {
  background: var(--theme-bg-elevated);
  color: var(--theme-text-secondary);
  border-color: var(--theme-border-strong);
}

[data-theme="dark"] .react-flow__controls button:hover {
  background: var(--theme-bg-hover);
}

[data-theme="dark"] .react-flow__minimap {
  background: var(--theme-bg-surface);
  border-color: var(--theme-border-strong);
}

/* --- React Flow overrides: Light mode ------------------------------------- */

[data-theme="light"] .react-flow__controls {
  background: var(--theme-bg-elevated);
  border-color: var(--theme-border-default);
}

[data-theme="light"] .react-flow__controls button {
  background: var(--theme-bg-surface);
  color: var(--theme-text-secondary);
  border-color: var(--theme-border-default);
}

[data-theme="light"] .react-flow__controls button:hover {
  background: var(--theme-bg-hover);
}

[data-theme="light"] .react-flow__minimap {
  background: var(--theme-bg-surface);
  border-color: var(--theme-border-default);
}
